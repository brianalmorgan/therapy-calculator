<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>Therapy Calculator</title>
  <meta name="description" content="Therapy Calculator">
  <meta name="author" content="Lauren Hallden">

  <!-- Form css -->
  <link rel="stylesheet" href="css/foundation.css" />
  <link rel="stylesheet" href="css/app.css">

  <link rel="stylesheet" href="stylesheets/screen.css">

  <!--[if lt IE 9]>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.js"></script>
  <![endif]-->
</head>

<body>
  <div class="container">
  <div class="intro">
    <h1>How much can I expect to pay for therapy?</h1>
    <p class="subhead">*in 2017 America</p>
  </div>

    <section id="section-1">
      <h2>Hey! I'm glad you're here.</h2>
      <p>I know the idea of budgeting for therapy is stressful, but it may not cost as much as you think. I'll try to get you some answers.</p>
      <p>
        <div class="disclaimer">
          <strong>A small disclaimer:</strong> I'm not a tax or insurance professional. I'm just <a href="http://www.laurenhallden.com">a web designer</a> who thinks this process should be less scary. Please consult an expert before making decisions that impact your finances and health.
        </div>
      </p>
      <p>The first question is an awkward one (sorry!): how much money does your household make in a year?</p>
      <form id="form-1" class="section-form" data-abide novalidate>
        <label><span>Your household income</span>
          <input id="income-field" type="text" aria-describedby="exampleHelpText" required pattern="number">
          <span class="form-error">
            Enter a number.
          </span>
        </label>
        <p class="help-text"> I won't share it with anyone, don't worry. I just need to do some math. But you can also <a href="">see a demo</a> with sample numbers.</p>
        <button class="button next-step">Next step</button>
      </form>
    </section>

    <!-- Your per session rate -->
    <section id="section-2" class="hidden">
      <div id="sliding-scale-div"><h2>Your per-session rate</h2></div>
      <p>I'd estimate that each session might cost you <span class="strong">$</span><span class="strong" id="baserate-span"></span>. But if you already have someone in mind and you know what they charge, you can adjust your rate.</p>
      <div class="col col-8 middle">
        <label>Set your rate to:</label>
        <div class="slider" data-slider data-options="start: 20; end: 150; step: 5;">
          <span class="slider-handle"  data-slider-handle role="slider" tabindex="1" aria-controls="sliderOutput1"></span>
          <span class="slider-fill" data-slider-fill></span>
        </div>
      </div>
      <div class="col col-4 middle padded-top">
        <input type="number" id="sliderOutput1">
      </div>

      <div id="accordion"></div>

      <p>If you see your therapist once a week, that's <span class="strong">$</span><span class="strong" id="yearly-cost-span"></span> over the course of a year.</p>
      <p>But don't worry just yet&mdash;let's see if we can lower that. Do you have health insurance? Some therapists don't accept it, but you may still be able to get some money back.</p>
      <a class="button next-step" href="#section-3" id="step-two-yes">Yes, let's check</a>
      <a class="button next-step" href="#section-6" id="step-two-no">Nope, no insurance</a>
    </section>

    <!-- Getting your health insurance -->
    <section id="section-3" class="hidden">
      <h2>Great! Now for the tricky part:</h2>
      <p>We're gonna need some details on your plan's mental health benefits. You can check online, or call your insurance company's help line to have a real person explain everything. You'll want to know:</p>
      <ul>
        <li>Is therapy delivered in an office setting covered by your plan?</li>
        <li>If your plan has a preferred network, what's your <strong>copayment</strong> for an in-network provider?</li>
        <li>What is the <strong>coinsurance rate</strong> for an out-of-network provider?</li>
        <li>What is your current <strong>deductible</strong>?</li>
      </ul>
      <p>When you're ready, let's walk through the options.</p>
      <form>
        <label><span>Your therapy appointments are</span>
          <select>
            <option value="covered">Covered or partially covered</option>
            <option value="not-covered">Not covered</option>
          </select>
        </label>
        <label><span>And your therapist is</span>
          <select>
            <option value="in-network">In-network</option>
            <option value="out-of-network">Out-of-network</option>
          </select>
        </label>
        <button class="next-step" id="step-two-yes">Next step</button>
      </form>
    </section>

    <!-- Getting your in-network benefits -->
    <section id="section-4" class="hidden">
      <h2>Nice!</h2>
      <p>Let's apply your insurance and see if that lowers your costs.</p>
      <form>
        <label><span>Your copay for therapy:</span>
          <input type="text" id="copay-field">
        </label>
        <p class="help-text">This is probably the same as what you'd pay to see a specialist.</p>
        <label><span>Your deductible:</span>
          <input type="text" id="deductible-field-innetwork">
        </label>
        <p class="help-text">You may not have one, but if you do, enter it here.</p>
        <button class="next-step" id="">Apply it!</button>
      </form>
    </section>

    <!-- Getting your out-of-network benefits -->
    <section id="section-5" class="hidden">
      <h2>Not a problem.</h2>
      <p>Let's see if the coverage you have will be helpful. I entered some example amounts here for you, but you should adjust them.</p>
      <form>
        <label><span>Your deductible:</span>
          <input type="text" id="deductible-field-outofnetwork" value="1000">
        </label>
        <p class="help-text">You can enter your yearly deducible, or if your deductible is pretty high and you don't typically reach it in a year, enter the amount you don't use up.</p>
        <label><span>Your coinsurance rate:</span>
          <input type="text" id="coinsurance-field" value="30">
        </label>
        <p class="help-text">Enter the percentage you are responsible for. For example, after you hit your deductible, your insurance may cover 70% of your costs, so your coinsurance rate is 30%</p>
        <button class="next-step" id="step-three">Looks good!</button>
      </form>
    </section>

    <!-- Applying your health insurance -->
    <section id="section-6" class="hidden">
      <h2>Let's try something else.</h2>
      <!--<p>Okay! That brought your cost down to <span class="strong">$</span><span class="strong" id="insurance-yearly-span"></span> per year, or about <span class="strong">$</span><span class="strong" id="insurance-baserate-span"></span> per session averaged out. Less scary, right?</p> -->
      <p>Another thing to check: <strong>tax deductions</strong>.</p>
      <p>I know, thinking about taxes is kinda terrible, but deductions can help you out! Taxes come into play if you're elligible for a Flexible Spending Account (FSA) or a Health Savings Account (HSA). You <em>may</em> even be able to deduct your therapy bills directly.</p>
      <form>
        <label><span>You have:</span>
          <select>
            <option value="fsa">A Flexbile Spending Account</option>
            <option value="hsa">A Health Savings Account</option>
            <option value="no-tax-plan">Neither</option>
          </select>
        </label>
        <button class="next-step" id="step-four-yes">Check deductions</button>
        <button class="next-step" id="step-four-no">Nope, skip this</button>
      </form>
    </section>

    <!-- Getting your FSA contribution -->
    <section id="section-8" class="hidden">
      <p>Cool. Let's assume you can put $<input id="fsa-field" value=""></span> in your FSA, and see how much that lowers your costs.</p>
      <button class="next-step" id="step-five-yes">Check it out</button>
      <button class="next-step" id="step-five-no">Skip it</button>
    </section>

    <!-- Applying your FSA contribution -->
    <section id="section-8" class="hidden">
      <p>Guess what? I think you can save <span id="tax-discount-span"></span> on your taxes.</p>
      <button class="next-step" id="final-step">Here's your final summary:</button>
    </section>

    <section id="section-9" class="hidden">
      <p>Your session rate: <span id="final-session-rate"></span></p>
      <p>A year of therapy might cost you <span id="final-yearly-cost"></span>, but you'll have saved <span id="insurance-saved"></span> by using your insurance and <span id="taxes-saved"></span> on your taxes by using your FSA.</p>
    </section>

    <div class="footer">
      <p>Want to help make this better?</p>
      <p><a href="https://github.com/laurenhallden/therapy-calculator">Contribute on GitHub</a></p>
    </div>


  </div> <!-- End container -->
	<!-- JS -->
    <script src="js/vendor/jquery.js"></script>
    <script src="js/vendor/what-input.js"></script>
    <script src="js/vendor/foundation.js"></script>
    <script src="js/app.js"></script>
    <script src="js/vendor/smooth-scroll.js"></script>
  <script src="js/scripts.js"></script>

  <!-- All our button functions -->
  <script>
    // Start with the assumption that we see a therapist once a week;
    // 48 times a year
    $( document ).ready(function() {
        window.globalNumberOfSessions = 48;
    });

    // Stop forms from posting on form submit
    $(".section-form").on("valid invalid submit", function(e){
      e.stopPropagation();
      e.preventDefault();
    });

    // Calculate baserate
    $("#form-1").on('formvalid.zf.abide', function(e) {
      console.log("valid trigger");
      var income = $.trim($("#income-field").val());
      window.globalIncome = income;
      stepOne(income);
      console.log("income:" + income);
    });

    $('.slider').on('changed.zf.slider', function() {
      var yearlyCostValue = $.trim($('#yearly-cost-span').html());
      if (yearlyCostValue =='') {
      }
      else {
        var currentSliderValue = $('#sliderOutput1').val();
        var updatedYearlyCost = currentSliderValue*globalNumberOfSessions;
        $('#yearly-cost-span').html(updatedYearlyCost);
      }
    });

    // Check insurance

    // Apply insurance
    $("#step-three").click(function(){
      var deductible = $.trim($("#deductible-field-outofnetwork").val());
      deductible = parseInt(deductible,10); // these need to be parsed to add them, steamline??
      console.log(deductible);
      var coinsurance = $.trim($("#coinsurance-field").val());
      coinsurance = parseInt(coinsurance,10);
      applyInsurance(deductible,coinsurance);
    });

    // Check FSA or HSA
    $("#step-four-yes-fsa").click(function(){setFSA()});
    $("#step-four-yes-hsa").click(function(){});
    $("#step-four-no").click(function(){});

    // Set FSA
    $("#step-five-yes").click(function(){
      var fsaAmount = $("#fsa-field").html()
      fsaAmount = parseInt(fsaAmount,10);
      getFSA(fsaAmount);
    });
    $("#step-five-no").click(function(){});

    // Get final summary!
    $("#final-step").click(function(){getSummary()});

  </script>
</body>
</html>