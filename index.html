<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>Therapy Calculator</title>
  <meta name="description" content="Therapy Calculator">
  <meta name="author" content="Lauren Hallden">

  <!-- Form css -->
  <link rel="stylesheet" href="css/foundation.css" />
  <link rel="stylesheet" href="css/app.css">
  <link rel="stylesheet" href="css/nprogress.css">

  <link rel="stylesheet" href="stylesheets/screen.css">

  <!--[if lt IE 9]>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.js"></script>
  <![endif]-->
</head>

<body>

  <!-- Script that checks which section is visible so we cna update teh progress bar -->
  <script type="text/javascript" src="https://unpkg.com/onscreen/dist/on-screen.umd.min.js"></script>
  <script type="text/javascript">
      var os = new OnScreen();
  </script>

  <div class="container">
  <div class="intro">
    <h1>How much can I expect to pay for therapy?</h1>
    <p class="subhead">*in 2017 America</p>
  </div>

    <section id="section-0">
      <h2>Hey! I’m glad you’re here.</h2>
      <p>I know the idea of budgeting for therapy is stressful, but it may not cost as much as you think. I’ll try to get you some answers.</p>
      <p>
        <div class="disclaimer">
          <strong>A small disclaimer:</strong> I’m not a tax or insurance professional. I’m just <a href="http://www.laurenhallden.com">a web designer</a> who thinks this process should be less scary. Please consider this an estimation, and consult an expert before making decisions that impact your finances and health.<br/><br/>Also, this calculator doesn’t cover Medicare and Medicaid just yet. I’m working on it, though!
        </div>
      </p>
      <p>The first question is an awkward one (sorry!): how much money does your household make in a year?</p>
      <form id="income-form" class="section-form" data-abide novalidate>
        <label><span>Your household income:</span>
          <input id="income-field" type="text" aria-describedby="income-help-text" required pattern="number">
          <span class="form-error">
            Enter a number.
          </span>
        </label>
        <p class="help-text" id="income-help-text"> I won’t share it with anyone, don’t worry. I just need to do some math.<!-- But you can also <a href="">see a demo</a> with sample numbers.--></p>
        <button class="button next-step">Next step</button>
      </form>
    </section>

    <!-- Your per session rate -->
    <section id="section-2" class="hidden">
      <div id="sliding-scale-div"><h2>Your per-session rate:</h2></div>
      <p>I’d estimate that each session might cost you <span class="strong">$</span><span class="strong" id="baserate-span"></span>. But if you already have someone in mind and you know what they charge, you can adjust your rate.</p>

      <!-- Slider -->
      <div class="col-wrapper">
        <div class="col col-8 middle">
          <label>Set your rate to:</label>
          <div class="slider" data-slider data-options="start: 20; end: 150; step: 5;">
            <span class="slider-handle"  data-slider-handle role="slider" tabindex="1" aria-controls="sliderOutput1"></span>
            <span class="slider-fill" data-slider-fill></span>
          </div>
        </div>
        <div class="col col-4 middle padded-top">
          <input type="number" id="sliderOutput1">
        </div>
      </div>

      <p>If you see your therapist once a week, that’s <span class="strong">$</span><span class="strong" id="yearly-cost-span"></span> over the course of a year.</p>
      <p>But don’t worry just yet&mdash;let’s see if we can lower that. Do you have health insurance? Some therapists don't accept it, but you may still be able to get some money back.</p>
      <button class="button next-step step-two" id="step-two-yes">Yes, let’s check</button>
      <button class="button next-step outline step-two" id="step-two-no">Nope, no insurance</a>
    </section>

    <!-- Getting your health insurance -->
    <section id="section-3" class="hidden">
      <h2>Great! Now for the tricky part:</h2>
      <p>We’re gonna need some details on your plan’s mental health benefits. You can check online, or call your insurance company’s help line to have a real person explain everything. You’ll want to know:</p>
      <ul>
        <li>Is therapy delivered in an office setting covered by your plan?</li>
        <li>If your plan has a preferred network, what's your <strong>copayment</strong> for an in-network provider?</li>
        <li>What is the <strong>co-insurance rate</strong> for an out-of-network provider?</li>
        <li>What is the <strong>approved amount</strong> for each therapy session?</li>
        <li>What is your current <strong>deductible</strong>?</li>
      </ul>
      <p>When you’re ready, let’s walk through the options.</p>
      <form>
        <label><span>Your therapy appointments are:</span>
          <select id="covered-or-not">
            <option value="covered">Covered or partially covered</option>
            <option value="not-covered">Not covered</option>
          </select>
        </label>
        <label id="network-or-not-label"><span>And your therapist is:</span>
          <select id="network-or-not">
            <option value="in-network">In-network</option>
            <option value="out-of-network">Out-of-network</option>
          </select>
        </label>
        <a class="button next-step" id="step-three">Next step</a>
      </form>
    </section>

    <!-- Getting your in-network benefits -->
    <section id="section-4" class="hidden">
      <h2>Nice!</h2>
      <p>Let’s apply your insurance and see if that lowers your costs.</p>
      <form id="in-network-form" class="section-form" data-abide novalidate>
        <label><span>Your copay for therapy:</span>
          <input type="text" id="copay-field" aria-describedby="copay-help-text" required pattern="number">
          <span class="form-error">
            Enter a number.
          </span>
        </label>
        <p class="help-text" id="copay-help-text">This is probably the same as what you’d pay to see a specialist.</p>
        <label><span>Your deductible:</span>
          <input type="text" id="deductible-field-innetwork" aria-describedby="deductible-help-text-innetwork" required pattern="number">
          <span class="form-error">
            Enter a number.
          </span>
        </label>
        <p class="help-text" id="deductible-help-text-innetwork">You may not have one, but if you do, enter it here.</p>
        <button class="button next-step" id="step-four">Apply it!</button>
      </form>
    </section>

    <!-- Getting your out-of-network benefits -->
    <section id="section-5" class="hidden">
      <h2>Not a problem.</h2>
      <p>The coverage you have may still be helpful. Let’s check. I entered some example amounts here for you, but you should adjust them.</p>
      <form id="outof-network-form" class="section-form" data-abide novalidate>
        <label><span>Your deductible:</span>
          <input type="text" id="deductible-field-outofnetwork" value="1000" aria-describedby="deductible-help-text-outofnetwork" required pattern="number">
          <span class="form-error">
            Enter a number.
          </span>
        </label>
        <p class="help-text" id="deductible-help-text-outofnetwork">You can enter your yearly deducible, or if you want to get specific, enter the amount you typically have left after your existing medical expenses. (It might be zero!)</p>
        <label><span>Your co-insurance rate:</span>
          <input type="text" id="coinsurance-field" value="30" aria-describedby="coinsurance-help-text" required pattern="number">
          <span class="form-error">
            Enter a number.
          </span>
        </label>
        <p class="help-text" id="coinsurance-help-text">Your coiinsurance rate is the percentage that you have to pay for each session after you’ve met your deductibe. For example, your insurance may cover 70% of each session, so your co-insurance would be 30%.</p>
        <label><span>Your plan's approved amount for each therapy session:</span>
          <input type="text" id="approved-amount-field" value="" aria-describedby="approved-amount-help-text" pattern="number">
          <span class="form-error">
            Enter a number.
          </span>
        </label>
        <p class="help-text" id="approved-amount-help-text">This is annoying, but your insurance can put a limit on what they think an hour of therapy <em>should</em> cost. For example, your therapist may charge you $100 an hour, but your insurance may decide this service is only worth $80. If you know you have an approved amount limit, enter it here. Otherwise we’ll assume you don’t.</p>
        <button class="button next-step" id="step-five">Looks good!</a>
      </form>
    </section>

    <!-- Applying your health insurance -->
    <section id="section-6" class="hidden">
      <div class="variable-content">
        <h2>Okay! Let’s try something else.</h2>
        <p id="insurance-results">That brought your cost down to <span class="strong">$</span><span class="strong" id="insurance-yearly-span"></span> per year, or about <span class="strong">$</span><span class="strong" id="insurance-baserate-span"></span> per session averaged out. Getting less scary?</p>
      </div>
      <p>There’s another thing to check: <strong>tax deductions</strong>.</p>
      <p>I know, thinking about taxes right now is kinda terrible. But deductions might make a big difference. Taxes come into play if you’re eligible for a <a target="_blank" href="https://www.healthcare.gov/have-job-based-coverage/flexible-spending-accounts/">Flexible Spending Account</a> (FSA) or a <a target="_blank" href="https://www.healthcare.gov/glossary/health-savings-account-HSA">Health Savings Account</a> (HSA). You <em>may</em> even be able to deduct your therapy bills directly.</p>
      <form>
        <label><span>Let’s see what happens if you have:</span>
          <select id="tax-vehicle">
            <option value="fsa">A Flexible Spending Account</option>
            <option value="hsa">A Health Savings Account</option>
            <option value="no-tax-vehicle">Neither</option>
          </select>
        </label>
        <button class="button next-step" id="step-six-yes">Check deductions</button>
        <a class ="button next-step outline" id="step-six-no" href="#section-9">Nope, skip the taxes stuff</a>
      </form>
    </section>

    <!-- Getting your FSA contribution -->
    <section id="section-7" class="hidden">
      <h2>Set your FSA contribution.</h2>
      <p>The more you contribute here, the more you can lower your tax burden. But there's a few things to keep in mind:</p>
      <ul class="ul-padded">
        <li>The maximum allowed in 2017 is <strong>$2,600</strong>.</li>
        <li>You can't change your FSA contributions mid-year. You'll have to wait for your next open enrollment period. This part of the calculation is only useful for future planning.</li>
      </ul>
      <p>If you’re already using an FSA, you may not have enough room left to add the full amount of therapy. In that case, take the maximum if you can.
      <p>Otherwise, let’s assume you can bump up your FSA contribution by:</p>
      <form id="fsa-form" class="section-form" data-abide novalidate>
          <input id="fsa-field" type="text" value="" required pattern="number">
          <span class="form-error">
            Enter a number.
          </span>
        <!-- Would be nice to set a max limit here -->
        <p>We’ll see how much that lowers your costs.</p>
        <button class="button next-step" id="step-seven-yes">Check it out</button>
        <a class="button next-step outline" id="step-seven-no">Nevermind, skip it</a>
      </form>
    </section>

    <!-- Getting your HSA contribution -->
    <section id="section-8" class="hidden">
      <h2>Set your HSA contribution.</h2>
      <p>First, let’s make sure you’re in the right place. Some things to keep in mind:</p>
      <ul class="ul-padded">
        <li>You can only have a Health Savings Account if you also have a qualifying <a target="_blank" href="https://www.healthcare.gov/glossary/high-deductible-health-plan/">high-deductible health plan</a>.</li>
        <li>If you do have an HSA, the maximum amount you’re allowed to contribute in 2017 is <strong>$3,400</strong> for an individual, or <strong>$6,750</strong> for a family. You can change the amount you contribute at any time during the year.</li>
      </ul>
      <p>If you’re already contributing, you may not have enough room left to add the full amount of therapy to your HSA. In that case, take the maximum if you can.</p>
      <p>Otherwise, let’s assume you can bump up your HSA contribution by:</p>
      <form id="hsa-form" class="section-form" data-abide novalidate>
          <input id="hsa-field" type="text" value="" required pattern="number">
          <span class="form-error">
            Enter a number.
          </span>
        <!-- Would be nice to set a max limit here -->
        <p>We’ll see how much that lowers your costs.</p>
        <button class="button next-step" id="step-eight-yes">Check it out</button>
        <a class="button next-step outline" id="step-eight-no">Nevermind, skip it</a>
      </form>
    </section>

    <!-- Applying your tax contributions -->
    <section id="section-9" class="hidden">
      <div class="variable-content">
        <h2>Let’s keep talking taxes (sorry!)</h2>
        <p id="tax-results">I think you can save <span class="strong">$</span><span class="strong" id="tax-discount-span"></span> on your taxes by using your___.</p>
      </div>
      <p>There’s <span id="additional-taxes">a</span> tax trick that might be of use to you: if your medical bills are <strong>more than 10%</strong> of your Adjusted Gross Income in 2017 (or 7.5% if you're over 65), you may be able to deduct them.</p>
      <p>Your Adjusted Gross income is your household income minus any other deductions, like student loan payments or mortgage interest.</p>
      <p>A few things to know:</p>
      <ul class="ul-padded">
        <li>This only applies to therapy that <a target="_blank" href="https://turbotax.intuit.com/tax-tools/tax-tips/Tax-Deductions-and-Credits/-Can-I-Claim-Medical-Expenses-on-My-Taxes-/INF14196.html">counts as medical care</a>, so you should talk to your therapist during your intake about your diagnosis. Things like marriage counseling may not count.</li>
        <li>I can’t know what all of your deductions might be, but I can tell you this: without additional deductions, your therapy bills are currently <strong><span id="income-percentage"></span>%</strong> of your Gross Adjusted Income.</li>
      </ul>
        <fieldset>
          <legend>So, you tell me: I’ll keep doing the math assuming either...</legend>
          <div class="radio-button">
            <input type="radio" name="itemized-deductions" value="Yes" id="yes-deduction">
            <label for="take-deduction">You want to take the medical deduction</label>
          </div>
          <div class="radio-button">
            <input type="radio" name="itemized-deductions" value="No" id="no-deduction" checked="checked">
            <label for="take-deduction">The medical deduction probably won’t apply to you</label>
          </div>
        </fieldset>
      <a class="button next-step" id="step-9">Next step (you’re almost finished!)</a>
    </section>

        <!-- Applying your itemized contributions -->
    <section id="section-10" class="hidden">
      <div class="variable-content">
        <h2>Guess what?</h2>
        <p id="itemized-tax-results">You may be able to save <span class="strong">$</span><span class="strong" id="itemized-tax-discount-span"></span> on your taxes by claiming your medical expenses.</p>
      </div>
      <a class="button next-step" id="step-10">Get your final summary</a>
    </section>

    <section id="section-11" class="hidden">
      <h2>We’re all done!</h2>
      <p>Here are my final estimations:</p>
      <p>Averaged over a year, each therapy session could cost you: <span class="strong">$</span><span class="strong" id="final-session-rate"></span></p>
      <p>A year of therapy could cost you: <span class="strong">$</span><span class="strong" <span id="final-yearly-cost"></span>
      <p id="but">
        But you’ll have saved 
        <span id="insurance-saved"><strong>$<span id="the-insurance-saved"></span></strong> by using your insurance</span><span id="and"> and </span><span id="taxes-saved"><strong>$<span id="the-taxes-saved"></span></strong> on your taxes</span>.
      </p>
      <label id="summary-tips-label">A few practical tips based on your situation:</label>
      <ul id="summary-tips" class="ul-padded">
      <ul>
    </section>

    <div class="footer">
      <p>Wanna help make this better?</p>
      <p><a href="https://github.com/laurenhallden/therapy-calculator">Contribute on GitHub</a></p>
      <div class="faq">
        <h2>Frequently asked questions</h2>
        <h3>How does this work?</h3>
        <p>This is a calculator that walks you through three ways to make therapy more affordable: sliding-scale fees, insurance options (even if your therapist doesn't accept insurance!), and tax deductions.</p>
        <h3>Do you save my data?<h3>
        <p>Nope. None of the forms here send any of your numbers anywhere beyond this page. They only use them to do some math.</p>
        <h3>Is this calculator correct?</h3>
        <p>Like I mentioned in the disclaimer, I'm not an expert! I am, however, currently paying for my own therapist with a mix of out-of-network insurance claims and a Flexible Spending Account. I wanted to show people how the sticker price for therapy isn't necessarily what you're stuck paying...and then I kept researching insurance and tax deduction combinations...and many hours later this calculator was born.</p>
        <p>Please think of this is an exploration into your options, and hop on the phone to talk to your insurance and tax professionals for verified expert advice.</p>
        <p>If you think something could be improved about this project, drop me an email at _____. You can also see and contribute directly to this project's code--it's open source.</p>
        <h3>Should I go to therapy?</h3>
        <p>That's a big question, and it's completely up to you and your doctors! They'll give you better advice than I can. But clearly, I'm a fan.</p>
        <h3>This is still too expensive. Do I have other options?</h3>
        <p><a target="_blank" href="https://www.buzzfeed.com/annaborges/affordable-therapy">This article on BuzzFeed</a> actually does a great job of walking you through some creative options for getting your fees lowered; from pro-bono therapy, to Employee Assistance Programs. You have lots of options.</p>
      </div>
    </div>


  </div> <!-- End container -->
	<!-- JS -->
    <script src="js/vendor/jquery.js"></script>
    <script src="js/vendor/what-input.js"></script>
    <script src="js/vendor/foundation.js"></script>
    <script src="js/app.js"></script>
    <script src="js/vendor/smooth-scroll.js"></script>
    <script src="js/vendor/nprogress.js"></script>
    <script src="js/scripts.js"></script>

  <!-- All our button functions -->
  <script>
    // Start with a bunch of assumptions and zeros until told otherwise
    $( document ).ready(function(){
        window.globalNumberOfSessions = 48; // we assume they see a therapist once a week
        window.globalInsuranceDiscount = 0;
        window.globalTaxDiscount = 0;
        window.globalTrackingReceipts = "no";
    });

    // Update progress bar based on current section
    os.on('enter', 'section', (element, event) => {
        var id = $(element).attr('id').replace(/section-/, '');
        var progress = (id/10.99);
        NProgress.set(progress);
    });

    // Stop forms from posting on form submit
    $(".section-form").on("valid invalid submit", function(e){
      e.stopPropagation();
      e.preventDefault();
    });

    // Calculate baserate
    $("#income-form").on('formvalid.zf.abide', function(e){
      var income = $.trim($("#income-field").val());
      window.globalIncome = income;
      stepOne(income);
      console.log("income:" + income);
    });

    // Update baserate based on slider
    $('.slider').on('changed.zf.slider', function(){
      var yearlyCostValue = $.trim($('#yearly-cost-span').html());
      console.log(yearlyCostValue);
      if (yearlyCostValue =='') {
      }
      else {
        var currentSliderValue = $('#sliderOutput1').val();
        var updatedYearlyCost = currentSliderValue*globalNumberOfSessions;
        $('#yearly-cost-span').html(updatedYearlyCost);
      }
    });

    // Grab the value of the slider and set the new yearly cost
    $(".step-two").click(function(){
      var id = this.id;
      var currentSliderValue = $('#sliderOutput1').val();
      var updatedYearlyCost = currentSliderValue*globalNumberOfSessions;
      window.globalYearlyCost = updatedYearlyCost;
      console.log(globalYearlyCost);
      // Then pick a next step
      if (id == "step-two-yes") {
        var location = "#section-3";
        scrollTo(location);
      }
      else {
        var location = "#section-6";
        scrollTo(location);
      }
    });

    // Check insurance
    $("#step-three").click(function(){
      var coveredYesNo = $('#covered-or-not :selected').val();
      var networkYesNo = $('#network-or-not :selected').val();
      checkInsurance(coveredYesNo, networkYesNo);
    });

    // Apply in-network insurance
    $("#in-network-form").on('formvalid.zf.abide', function(e){
      var copay = $.trim($("#copay-field").val());
      copay = parseInt(copay,10);
      //console.log(copay);
      var deductible = $.trim($("#deductible-field-innetwork").val());
      deductible = parseInt(deductible,10);
      applyNetworkInsurance(copay,deductible);
    });

    // Apply out-of-network insurance
    $("#outof-network-form").on('formvalid.zf.abide', function(e){
      var deductible = $("#deductible-field-outofnetwork").val();
      deductible = parseInt(deductible,10);
      //console.log(deductible);
      var coinsurance = $("#coinsurance-field").val();
      coinsurance = parseInt(coinsurance,10);
      if ($("#approved-amount-field").val() != "") {
        var approvedAmount = $("#approved-amount-field").val();
      }
      else {
        var approvedAmount = 1000; // Just pick a random high number
      }
      approvedAmount = parseInt(approvedAmount,10);
      console.log(approvedAmount);
      applyInsurance(deductible,coinsurance,approvedAmount);
    });

    // Check FSA or HSA...
    $("#step-six-yes").click(function(){
      var taxVehicle = $('#tax-vehicle :selected').val();
      if ( taxVehicle == "fsa") {
        setFSA();
      }
      else if ( taxVehicle == "hsa") {
        setHSA();
      }
      else {
        var location = "#section-9";
        scrollTo(location);
        checkItemized();
      }
    });

    // ...or skip taxes section completely.
    $("#step-six-no").click(function(){
      getSummary();
    });

    // Do the FSA math
    $("#fsa-form").on('formvalid.zf.abide', function(e){
      var contribution = $("#fsa-field").val();
      var fromWhere = "fsa";
      doTaxes(contribution, fromWhere);
    });

    // Skip forward if they decide not to use an FSA
    $("#step-seven-no").click(function(){
        var location = "#section-9";
        scrollTo(location);
        checkItemized();
    });

    // Do the HSA math
    $("#hsa-form").on('formvalid.zf.abide', function(e){
      var contribution = $("#hsa-field").val();
      var fromWhere = "hsa";
      doTaxes(contribution, fromWhere);
    });

    // Skip forward if they decide not to use an HSA
    $("#step-eight-no").click(function(){
        var location = "#section-9";
        scrollTo(location);
        checkItemized();
    });

    // Get the final summary!
    $("#step-9").click(function(){
      var itemizedYesNo = $('#yes-deduction:checked').val();
      console.log(itemizedYesNo);
       if (itemizedYesNo == 'Yes') {
        getItemized();
       }
       else {
        getSummary();
       }
    });

    $("#step-10").click(function(){
      getSummary();
    });

  </script>
</body>
</html>